{"ast":null,"code":"import{useEffect,useState}from\"react\";import{activateSpotifyDevice,startPlayback,checkActiveDevice}from\"../utils/SpotifyAPI\";import{jsx as _jsx}from\"react/jsx-runtime\";const SpotifyPlayer=_ref=>{let{accessToken,onReady}=_ref;const[player,setPlayer]=useState(null);const[deviceId,setDeviceId]=useState(null);const[isReady,setIsReady]=useState(false);useEffect(()=>{if(!accessToken){console.warn(\"‚ö†Ô∏è Kein Spotify Access Token verf√ºgbar!\");loginWithSpotify();return;}const script=document.createElement(\"script\");script.src=\"https://sdk.scdn.co/spotify-player.js\";script.async=true;document.body.appendChild(script);const onSpotifySDKReady=()=>{if(!window.Spotify){console.error(\"‚ùå Spotify SDK konnte nicht geladen werden.\");return;}const newPlayer=new window.Spotify.Player({name:\"Song Quiz Player\",getOAuthToken:cb=>cb(accessToken),volume:0.5});newPlayer.addListener(\"ready\",async _ref2=>{let{device_id}=_ref2;console.log(\"‚úÖ Spotify Player ist bereit mit ID:\",device_id);setDeviceId(device_id);setIsReady(true);onReady(device_id);await activateSpotifyDevice(device_id,accessToken);await checkActiveDevice(accessToken);await startPlayback(device_id,accessToken);});newPlayer.addListener(\"not_ready\",_ref3=>{let{device_id}=_ref3;console.error(\"‚ùå Spotify Player ist nicht bereit!\",device_id);setIsReady(false);});newPlayer.addListener(\"initialization_error\",_ref4=>{let{message}=_ref4;console.error(\"‚ùå Initialisierungsfehler:\",message);});newPlayer.addListener(\"authentication_error\",_ref5=>{let{message}=_ref5;console.error(\"‚ùå Authentifizierungsfehler ‚Äì Token k√∂nnte abgelaufen sein!\",message);});newPlayer.addListener(\"account_error\",_ref6=>{let{message}=_ref6;console.error(\"‚ùå Konto-Fehler:\",message);});newPlayer.connect().then(success=>{if(success){console.log(\"üéµ Spotify Player erfolgreich verbunden!\");}else{console.error(\"‚ùå Verbindung zum Spotify Player fehlgeschlagen!\");}});setPlayer(newPlayer);};window.onSpotifyWebPlaybackSDKReady=onSpotifySDKReady;return()=>{console.log(\"üîÑ Spotify Player wird bereinigt...\");script.remove();if(player){player.disconnect();}};},[accessToken]);return/*#__PURE__*/_jsx(\"p\",{children:isReady?\"üéµ Spotify Player ist bereit!\":\"‚è≥ Lade Spotify Player...\"});};export default SpotifyPlayer;","map":{"version":3,"names":["useEffect","useState","activateSpotifyDevice","startPlayback","checkActiveDevice","jsx","_jsx","SpotifyPlayer","_ref","accessToken","onReady","player","setPlayer","deviceId","setDeviceId","isReady","setIsReady","console","warn","loginWithSpotify","script","document","createElement","src","async","body","appendChild","onSpotifySDKReady","window","Spotify","error","newPlayer","Player","name","getOAuthToken","cb","volume","addListener","_ref2","device_id","log","_ref3","_ref4","message","_ref5","_ref6","connect","then","success","onSpotifyWebPlaybackSDKReady","remove","disconnect","children"],"sources":["/workspaces/Quizdiezweite/music-quiz/client/src/components/SpotifyPlayer.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { activateSpotifyDevice, startPlayback, checkActiveDevice } from \"../utils/SpotifyAPI\";\n\nconst SpotifyPlayer = ({ accessToken, onReady }) => {\n  const [player, setPlayer] = useState(null);\n  const [deviceId, setDeviceId] = useState(null);\n  const [isReady, setIsReady] = useState(false);\n\n  useEffect(() => {\n    if (!accessToken) {\n      console.warn(\"‚ö†Ô∏è Kein Spotify Access Token verf√ºgbar!\");\n      loginWithSpotify();\n      return;\n    }\n\n    const script = document.createElement(\"script\");\n    script.src = \"https://sdk.scdn.co/spotify-player.js\";\n    script.async = true;\n    document.body.appendChild(script);\n\n    const onSpotifySDKReady = () => {\n      if (!window.Spotify) {\n        console.error(\"‚ùå Spotify SDK konnte nicht geladen werden.\");\n        return;\n      }\n\n      const newPlayer = new window.Spotify.Player({\n        name: \"Song Quiz Player\",\n        getOAuthToken: (cb) => cb(accessToken),\n        volume: 0.5,\n      });\n\n      newPlayer.addListener(\"ready\", async ({ device_id }) => {\n        console.log(\"‚úÖ Spotify Player ist bereit mit ID:\", device_id);\n        setDeviceId(device_id);\n        setIsReady(true);\n        onReady(device_id);\n\n        await activateSpotifyDevice(device_id, accessToken);\n        await checkActiveDevice(accessToken);\n        await startPlayback(device_id, accessToken);\n      });\n\n      newPlayer.addListener(\"not_ready\", ({ device_id }) => {\n        console.error(\"‚ùå Spotify Player ist nicht bereit!\", device_id);\n        setIsReady(false);\n      });\n\n      newPlayer.addListener(\"initialization_error\", ({ message }) => {\n        console.error(\"‚ùå Initialisierungsfehler:\", message);\n      });\n\n      newPlayer.addListener(\"authentication_error\", ({ message }) => {\n        console.error(\"‚ùå Authentifizierungsfehler ‚Äì Token k√∂nnte abgelaufen sein!\", message);\n      });\n\n      newPlayer.addListener(\"account_error\", ({ message }) => {\n        console.error(\"‚ùå Konto-Fehler:\", message);\n      });\n\n      newPlayer.connect().then((success) => {\n        if (success) {\n          console.log(\"üéµ Spotify Player erfolgreich verbunden!\");\n        } else {\n          console.error(\"‚ùå Verbindung zum Spotify Player fehlgeschlagen!\");\n        }\n      });\n\n      setPlayer(newPlayer);\n    };\n\n    window.onSpotifyWebPlaybackSDKReady = onSpotifySDKReady;\n\n    return () => {\n      console.log(\"üîÑ Spotify Player wird bereinigt...\");\n      script.remove();\n      if (player) {\n        player.disconnect();\n      }\n    };\n  }, [accessToken]);\n\n  return (\n    <p>{isReady ? \"üéµ Spotify Player ist bereit!\" : \"‚è≥ Lade Spotify Player...\"}</p>\n  );\n};\n\nexport default SpotifyPlayer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}